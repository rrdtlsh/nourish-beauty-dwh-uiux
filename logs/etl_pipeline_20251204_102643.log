2025-12-04 10:26:43,556 - __main__ - INFO - ================================================================================
2025-12-04 10:26:43,556 - __main__ - INFO - NOURISH BEAUTY DATA WAREHOUSE - ETL PIPELINE
2025-12-04 10:26:43,556 - __main__ - INFO -    Author: Raudatul Sholehah - 2310817220002
2025-12-04 10:26:43,556 - __main__ - INFO -    Date: 2025-12-04 10:26:43
2025-12-04 10:26:43,556 - __main__ - INFO - ================================================================================
2025-12-04 10:26:43,556 - __main__ - INFO - 
2025-12-04 10:26:43,556 - __main__ - INFO - STEP 1: Testing Database Connection
2025-12-04 10:26:43,556 - __main__ - INFO - --------------------------------------------------------------------------------
2025-12-04 10:26:43,925 - __main__ - INFO - 
2025-12-04 10:26:43,930 - __main__ - INFO - STEP 2: EXTRACT PHASE
2025-12-04 10:26:43,930 - __main__ - INFO - --------------------------------------------------------------------------------
2025-12-04 10:26:44,404 - __main__ - INFO - Extracting Sales Data...
2025-12-04 10:26:44,404 - etl.extract.extract_sales - INFO - Starting sales data extraction...
2025-12-04 10:26:44,404 - etl.extract.extract_sales - INFO - Reading file: D:\FILE SM 5\nourish-beauty-dwh-uiux\data\raw\SuperMarket-Analysis-penjualan.csv
2025-12-04 10:26:44,412 - etl.extract.extract_sales - INFO - [OK] Loaded 1000 rows from SuperMarket-Analysis-penjualan.csv
2025-12-04 10:26:44,412 - etl.extract.extract_sales - INFO - Applying transformations...
2025-12-04 10:26:44,412 - etl.transform.transform_sales - INFO - Applying 40 transformation rules to sales data...
2025-12-04 10:26:44,413 - etl.transform.transform_sales - INFO -    Initial row count: 1000
2025-12-04 10:26:44,413 - etl.transform.transform_sales - INFO - RULE 0: Pre-cleaning Indonesian number format...
2025-12-04 10:26:44,415 - etl.transform.transform_sales - INFO -    Fixed persentase_gross_margin scale
2025-12-04 10:26:44,416 - etl.transform.transform_sales - INFO - RULE 1-5: Data Type Conversion
2025-12-04 10:26:44,419 - etl.transform.transform_sales - INFO - RULE 6-10: Handle Missing Values
2025-12-04 10:26:44,422 - etl.transform.transform_sales - INFO - RULE 11-15: Data Cleaning
2025-12-04 10:26:44,428 - etl.transform.transform_sales - INFO - RULE 16-20: Standardization
2025-12-04 10:26:44,432 - etl.transform.transform_sales - INFO - RULE 21-25: Calculate Derived Fields
2025-12-04 10:26:44,435 - etl.transform.transform_sales - INFO - RULE 26-30: Validation & Quality Checks
2025-12-04 10:26:44,440 - etl.transform.transform_sales - INFO - RULE 31-35: Business Logic & Categorization
2025-12-04 10:26:44,448 - etl.transform.transform_sales - INFO - RULE 36-40: Final Cleaning & Outlier Removal
2025-12-04 10:26:44,453 - etl.transform.transform_sales - INFO - [OK] Transformation complete!
2025-12-04 10:26:44,454 - etl.transform.transform_sales - INFO -    Initial rows: 1000
2025-12-04 10:26:44,454 - etl.transform.transform_sales - INFO -    Final rows: 991
2025-12-04 10:26:44,454 - etl.transform.transform_sales - INFO -    Removed: 9 (0.9%)
2025-12-04 10:26:44,454 - etl.transform.transform_sales - INFO -    Retention rate: 99.1%
2025-12-04 10:26:44,470 - etl.extract.extract_sales - INFO - [OK] Saved to staging file: D:\FILE SM 5\nourish-beauty-dwh-uiux\data\staging\staging_sales.csv
2025-12-04 10:26:44,471 - etl.extract.extract_sales - INFO - [OK] Extraction complete: 991 records ready
2025-12-04 10:26:44,471 - etl.extract.extract_sales - INFO - Loading sales data to staging_sales table...
2025-12-04 10:26:44,472 - etl.extract.extract_sales - INFO -    Records to load: 991
2025-12-04 10:26:44,472 - etl.extract.extract_sales - INFO -    Truncating staging_sales table...
2025-12-04 10:26:44,516 - etl.extract.extract_sales - INFO -    Loading data in 2 chunks of 500 rows...
2025-12-04 10:26:44,688 - etl.extract.extract_sales - INFO -    Chunk 1/2 loaded (500 rows)
2025-12-04 10:26:44,814 - etl.extract.extract_sales - INFO -    Chunk 2/2 loaded (491 rows)
2025-12-04 10:26:44,830 - etl.extract.extract_sales - INFO - [OK] Successfully loaded 991 rows to staging_sales
2025-12-04 10:26:44,830 - etl.extract.extract_sales - INFO - [OK] Verified staging_sales row count: 991
2025-12-04 10:26:44,830 - __main__ - INFO - Extracting HR Data...
2025-12-04 10:26:44,830 - etl.extract.extract_hr - INFO - Starting HR data extraction...
2025-12-04 10:26:44,830 - etl.extract.extract_hr - INFO - Reading file: D:\FILE SM 5\nourish-beauty-dwh-uiux\data\raw\HRDataset.csv
2025-12-04 10:26:44,830 - etl.extract.extract_hr - INFO - [OK] Loaded 311 rows from HRDataset.csv
2025-12-04 10:26:44,830 - etl.extract.extract_hr - INFO -    Columns: 36
2025-12-04 10:26:44,841 - etl.extract.extract_hr - INFO -    Converting date column: dob
2025-12-04 10:26:44,843 - etl.extract.extract_hr - INFO -    Converting date column: dateofhire
2025-12-04 10:26:44,843 - etl.extract.extract_hr - INFO -    Converting date column: dateoftermination
2025-12-04 10:26:44,845 - etl.extract.extract_hr - INFO -    Converting date column: lastperformancereview_date
2025-12-04 10:26:44,859 - etl.extract.extract_hr - INFO - [OK] Saved to staging file: D:\FILE SM 5\nourish-beauty-dwh-uiux\data\staging\staging_hr.csv
2025-12-04 10:26:44,861 - etl.extract.extract_hr - INFO - [OK] Extraction complete: 311 records ready
2025-12-04 10:26:44,861 - etl.extract.extract_hr - INFO - Loading HR data to staging_hr table...
2025-12-04 10:26:44,861 - etl.extract.extract_hr - INFO -    Records to load: 311
2025-12-04 10:26:44,862 - etl.extract.extract_hr - INFO -    Truncating staging_hr table...
2025-12-04 10:26:45,002 - etl.extract.extract_hr - INFO -    Loading rows individually...
2025-12-04 10:26:45,475 - etl.extract.extract_hr - INFO -    Progress: 50/311 rows loaded
2025-12-04 10:26:45,939 - etl.extract.extract_hr - INFO -    Progress: 100/311 rows loaded
2025-12-04 10:26:46,432 - etl.extract.extract_hr - INFO -    Progress: 150/311 rows loaded
2025-12-04 10:26:46,890 - etl.extract.extract_hr - INFO -    Progress: 200/311 rows loaded
2025-12-04 10:26:47,318 - etl.extract.extract_hr - INFO -    Progress: 250/311 rows loaded
2025-12-04 10:26:47,750 - etl.extract.extract_hr - INFO -    Progress: 300/311 rows loaded
2025-12-04 10:26:47,844 - etl.extract.extract_hr - INFO -    Progress: 311/311 rows loaded
2025-12-04 10:26:47,844 - etl.extract.extract_hr - INFO - [OK] Successfully loaded 311 rows
2025-12-04 10:26:47,844 - etl.extract.extract_hr - INFO - [OK] Verified row count: 311
2025-12-04 10:26:47,844 - __main__ - INFO - Extracting Marketing Data...
2025-12-04 10:26:47,844 - etl.extract.extract_marketing - INFO - Starting marketing data extraction...
2025-12-04 10:26:47,844 - etl.extract.extract_marketing - INFO - Reading file: D:\FILE SM 5\nourish-beauty-dwh-uiux\data\raw\marketing_campaign.csv
2025-12-04 10:26:47,844 - etl.extract.extract_marketing - INFO -    Trying delimiter: '	'
2025-12-04 10:26:47,844 - etl.extract.extract_marketing - WARNING -    Failed: only 1 columns detected
2025-12-04 10:26:47,844 - etl.extract.extract_marketing - INFO -    Trying delimiter: ';'
2025-12-04 10:26:47,878 - etl.extract.extract_marketing - INFO -    [OK] Successfully read with delimiter ';'
2025-12-04 10:26:47,878 - etl.extract.extract_marketing - INFO -    Columns detected: 29
2025-12-04 10:26:47,879 - etl.extract.extract_marketing - INFO - [OK] Loaded 1000 rows from marketing_campaign.csv
2025-12-04 10:26:47,879 - etl.extract.extract_marketing - INFO -    Columns: ['ID', 'Year_Birth', 'Education', 'Marital_Status', 'Income']... (29 total)
2025-12-04 10:26:47,880 - etl.extract.extract_marketing - INFO -    Converting date column: dt_customer
2025-12-04 10:26:47,903 - etl.extract.extract_marketing - INFO - [OK] Saved to staging file: D:\FILE SM 5\nourish-beauty-dwh-uiux\data\staging\staging_marketing.csv
2025-12-04 10:26:47,903 - etl.extract.extract_marketing - INFO - [OK] Extraction complete: 1000 records ready
2025-12-04 10:26:47,903 - etl.extract.extract_marketing - INFO - Loading marketing data to staging_marketing table...
2025-12-04 10:26:47,904 - etl.extract.extract_marketing - INFO -    Records to load: 1000
2025-12-04 10:26:47,905 - etl.extract.extract_marketing - INFO -    Dropping and recreating staging_marketing table...
2025-12-04 10:26:47,951 - etl.extract.extract_marketing - INFO -    Loading data with auto-schema detection...
2025-12-04 10:26:48,348 - etl.extract.extract_marketing - INFO - [OK] Successfully loaded 1000 rows
2025-12-04 10:26:48,362 - etl.extract.extract_marketing - INFO - [OK] Verified row count: 1000
2025-12-04 10:26:48,364 - __main__ - INFO - [OK] Extract phase completed!
2025-12-04 10:26:48,364 - __main__ - INFO - 
2025-12-04 10:26:48,364 - __main__ - INFO - STEP 3: TRANSFORM PHASE
2025-12-04 10:26:48,364 - __main__ - INFO - --------------------------------------------------------------------------------
2025-12-04 10:26:48,364 - __main__ - INFO - Transformation rules will be applied during load phase
2025-12-04 10:26:48,364 - __main__ - INFO - [OK] 40 transformation rules ready
2025-12-04 10:26:48,364 - __main__ - INFO - 
2025-12-04 10:26:48,364 - __main__ - INFO - STEP 4: LOAD DIMENSIONS
2025-12-04 10:26:48,364 - __main__ - INFO - --------------------------------------------------------------------------------
2025-12-04 10:26:48,385 - etl.load.load_dimensions - INFO - ======================================================================
2025-12-04 10:26:48,385 - etl.load.load_dimensions - INFO - STARTING DIMENSION LOAD PROCESS
2025-12-04 10:26:48,385 - etl.load.load_dimensions - INFO - ======================================================================
2025-12-04 10:26:48,385 - etl.load.load_dimensions - INFO - Loading dim_produk...
2025-12-04 10:26:48,569 - etl.load.load_dimensions - INFO - [OK] Loaded 6 products to dim_produk
2025-12-04 10:26:48,569 - etl.load.load_dimensions - INFO - Loading dim_customer...
2025-12-04 10:26:48,763 - etl.load.load_dimensions - ERROR - [ERROR] Error loading dim_customer: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "dim_customer_customer_id_key"
DETAIL:  Key (customer_id)=(8151) already exists.

[SQL: INSERT INTO dim_customer (customer_id, year_birth, age, education, marital_status, income, kidhome, teenhome, dt_customer, customer_segment, total_spending, is_active, created_date, updated_date) VALUES (%(customer_id_m0)s, %(year_birth_m0)s, %(age_m0)s, %(education_m0)s, %(marital_status_m0)s, %(income_m0)s, %(kidhome_m0)s, %(teenhome_m0)s, %(dt_customer_m0)s, %(customer_segment_m0)s, %(total_spending_m0)s, %(is_active_m0)s, %(created_date_m0)s, %(updated_date_m0)s), (%(customer_id_m1)s, %(year_birth_m1)s, %(age_m1)s, %(education_m1)s, %(marital_status_m1)s, %(income_m1)s, %(kidhome_m1)s, %(teenhome_m1)s, %(dt_customer_m1)s, %(customer_segment_m1)s, %(total_spending_m1)s, %(is_active_m1)s, %(created_date_m1)s, %(updated_date_m1)s), (%(customer_id_m2)s, %(year_birth_m2)s, %(age_m2)s, %(education_m2)s, %(marital_status_m2)s, %(income_m2)s, %(kidhome_m2)s, %(teenhome_m2)s, %(dt_customer_m2)s, %(customer_segment_m2)s, %(total_spending_m2)s, %(is_active_m2)s, %(created_date_m2)s, %(updated_date_m2)s), (%(customer_id_m3)s, %(year_birth_m3)s, %(age_m3)s, %(education_m3)s, %(marital_status_m3)s, %(income_m3)s, %(kidhome_m3)s, %(teenhome_m3)s, %(dt_customer_m3)s, %(customer_segment_m3)s, %(total_spending_m3)s, %(is_active_m3)s, %(created_date_m3)s, %(updated_date_m3)s), (%(customer_id_m4)s, %(year_birth_m4)s, %(age_m4)s, %(education_m4)s, %(marital_status_m4)s, %(income_m4)s, %(kidhome_m4)s, %(teenhome_m4)s, %(dt_customer_m4)s, %(customer_segment_m4)s, %(total_spending_m4)s, %(is_active_m4)s, %(created_date_m4)s, %(updated_date_m4)s), (%(customer_id_m5)s, %(year_birth_m5)s, %(age_m5)s, %(education_m5)s, %(marital_status_m5)s, %(income_m5)s, %(kidhome_m5)s, %(teenhome_m5)s, %(dt_customer_m5)s, %(customer_segment_m5)s, %(total_spending_m5)s, %(is_active_m5)s, %(created_date_m5)s, %(updated_date_m5)s), (%(customer_id_m6)s, %(year_birth_m6)s, %(age_m6)s, %(education_m6)s, %(marital_status_m6)s, %(income_m6)s, %(kidhome_m6)s, %(teenhome_m6)s, %(dt_customer_m6)s, %(customer_segment_m6)s, %(total_spending_m6)s, %(is_active_m6)s, %(created_date_m6)s, %(updated_date_m6)s), (%(customer_id_m7)s, %(year_birth_m7)s, %(age_m7)s, %(education_m7)s, %(marital_status_m7)s, %(income_m7)s, %(kidhome_m7)s, %(teenhome_m7)s, %(dt_customer_m7)s, %(customer_segment_m7)s, %(total_spending_m7)s, %(is_active_m7)s, %(created_date_m7)s, %(updated_date_m7)s), (%(customer_id_m8)s, %(year_birth_m8)s, %(age_m8)s, %(education_m8)s, %(marital_status_m8)s, %(income_m8)s, %(kidhome_m8)s, %(teenhome_m8)s, %(dt_customer_m8)s, %(customer_segment_m8)s, %(total_spending_m8)s, %(is_active_m8)s, %(created_date_m8)s, %(updated_date_m8)s), (%(customer_id_m9)s, %(year_birth_m9)s, %(age_m9)s, %(education_m9)s, %(marital_status_m9)s, %(income_m9)s, %(kidhome_m9)s, %(teenhome_m9)s, %(dt_customer_m9)s, %(customer_segment_m9)s, %(total_spending_m9)s, %(is_active_m9)s, %(created_date_m9)s, %(updated_date_m9)s), (%(customer_id_m10)s, %(year_birth_m10)s, %(age_m10)s, %(education_m10)s, %(marital_status_m10)s, %(income_m10)s, %(kidhome_m10)s, %(teenhome_m10)s, %(dt_customer_m10)s, %(customer_segment_m10)s, %(total_spending_m10)s, %(is_active_m10)s, %(created_date_m10)s, %(updated_date_m10)s), (%(customer_id_m11)s, %(year_birth_m11)s, %(age_m11)s, %(education_m11)s, %(marital_status_m11)s, %(income_m11)s, %(kidhome_m11)s, %(teenhome_m11)s, %(dt_customer_m11)s, %(customer_segment_m11)s, %(total_spending_m11)s, %(is_active_m11)s, %(created_date_m11)s, %(updated_date_m11)s), (%(customer_id_m12)s, %(year_birth_m12)s, %(age_m12)s, %(education_m12)s, %(marital_status_m12)s, %(income_m12)s, %(kidhome_m12)s, %(teenhome_m12)s, %(dt_customer_m12)s, %(customer_segment_m12)s, %(total_spending_m12)s, %(is_active_m12)s, %(created_date_m12)s, %(updated_date_m12)s), (%(customer_id_m13)s, %(year_birth_m13)s, %(age_m13)s, %(education_m13)s, %(marital_status_m13)s, %(income_m13)s, %(kidhome_m13)s, %(teenhome_m13)s, %(dt_customer_m13)s, %(customer_segment_m13)s, %(total_spending_m13)s, %(is_active_m13)s, %(created_date_m13)s, %(updated_date_m13)s), (%(customer_id_m14)s, %(year_birth_m14)s, %(age_m14)s, %(education_m14)s, %(marital_status_m14)s, %(income_m14)s, %(kidhome_m14)s, %(teenhome_m14)s, %(dt_customer_m14)s, %(customer_segment_m14)s, %(total_spending_m14)s, %(is_active_m14)s, %(created_date_m14)s, %(updated_date_m14)s), (%(customer_id_m15)s, %(year_birth_m15)s, %(age_m15)s, %(education_m15)s, %(marital_status_m15)s, %(income_m15)s, %(kidhome_m15)s, %(teenhome_m15)s, %(dt_customer_m15)s, %(customer_segment_m15)s, %(total_spending_m15)s, %(is_active_m15)s, %(created_date_m15)s, %(updated_date_m15)s), (%(customer_id_m16)s, %(year_birth_m16)s, %(age_m16)s, %(education_m16)s, %(marital_status_m16)s, %(income_m16)s, %(kidhome_m16)s, %(teenhome_m16)s, %(dt_customer_m16)s, %(customer_segment_m16)s, %(total_spending_m16)s, %(is_active_m16)s, %(created_date_m16)s, %(updated_date_m16)s), (%(customer_id_m17)s, %(year_birth_m17)s, %(age_m17)s, %(education_m17)s, %(marital_status_m17)s, %(income_m17)s, %(kidhome_m17)s, %(teenhome_m17)s, %(dt_customer_m17)s, %(customer_segment_m17)s, %(total_spending_m17)s, %(is_active_m17)s, %(created_date_m17)s, %(updated_date_m17)s), (%(customer_id_m18)s, %(year_birth_m18)s, %(age_m18)s, %(education_m18)s, %(marital_status_m18)s, %(income_m18)s, %(kidhome_m18)s, %(teenhome_m18)s, %(dt_customer_m18)s, %(customer_segment_m18)s, %(total_spending_m18)s, %(is_active_m18)s, %(created_date_m18)s, %(updated_date_m18)s), (%(customer_id_m19)s, %(year_birth_m19)s, %(age_m19)s, %(education_m19)s, %(marital_status_m19)s, %(income_m19)s, %(kidhome_m19)s, %(teenhome_m19)s, %(dt_customer_m19)s, %(customer_segment_m19)s, %(total_spending_m19)s, %(is_active_m19)s, %(created_date_m19)s, %(updated_date_m19)s), (%(customer_id_m20)s, %(year_birth_m20)s, %(age_m20)s, %(education_m20)s, %(marital_status_m20)s, %(income_m20)s, %(kidhome_m20)s, %(teenhome_m20)s, %(dt_customer_m20)s, %(customer_segment_m20)s, %(total_spending_m20)s, %(is_active_m20)s, %(created_date_m20)s, %(updated_date_m20)s), (%(customer_id_m21)s, %(year_birth_m21)s, %(age_m21)s, %(education_m21)s, %(marital_status_m21)s, %(income_m21)s, %(kidhome_m21)s, %(teenhome_m21)s, %(dt_customer_m21)s, %(customer_segment_m21)s, %(total_spending_m21)s, %(is_active_m21)s, %(created_date_m21)s, %(updated_date_m21)s), (%(customer_id_m22)s, %(year_birth_m22)s, %(age_m22)s, %(education_m22)s, %(marital_status_m22)s, %(income_m22)s, %(kidhome_m22)s, %(teenhome_m22)s, %(dt_customer_m22)s, %(customer_segment_m22)s, %(total_spending_m22)s, %(is_active_m22)s, %(created_date_m22)s, %(updated_date_m22)s), (%(customer_id_m23)s, %(year_birth_m23)s, %(age_m23)s, %(education_m23)s, %(marital_status_m23)s, %(income_m23)s, %(kidhome_m23)s, %(teenhome_m23)s, %(dt_customer_m23)s, %(customer_segment_m23)s, %(total_spending_m23)s, %(is_active_m23)s, %(created_date_m23)s, %(updated_date_m23)s), (%(customer_id_m24)s, %(year_birth_m24)s, %(age_m24)s, %(education_m24)s, %(marital_status_m24)s, %(income_m24)s, %(kidhome_m24)s, %(teenhome_m24)s, %(dt_customer_m24)s, %(customer_segment_m24)s, %(total_spending_m24)s, %(is_active_m24)s, %(created_date_m24)s, %(updated_date_m24)s), (%(customer_id_m25)s, %(year_birth_m25)s, %(age_m25)s, %(education_m25)s, %(marital_status_m25)s, %(income_m25)s, %(kidhome_m25)s, %(teenhome_m25)s, %(dt_customer_m25)s, %(customer_segment_m25)s, %(total_spending_m25)s, %(is_active_m25)s, %(created_date_m25)s, %(updated_date_m25)s), (%(customer_id_m26)s, %(year_birth_m26)s, %(age_m26)s, %(education_m26)s, %(marital_status_m26)s, %(income_m26)s, %(kidhome_m26)s, %(teenhome_m26)s, %(dt_customer_m26)s, %(customer_segment_m26)s, %(total_spending_m26)s, %(is_active_m26)s, %(created_date_m26)s, %(updated_date_m26)s), (%(customer_id_m27)s, %(year_birth_m27)s, %(age_m27)s, %(education_m27)s, %(marital_status_m27)s, %(income_m27)s, %(kidhome_m27)s, %(teenhome_m27)s, %(dt_customer_m27)s, %(customer_segment_m27)s, %(total_spending_m27)s, %(is_active_m27)s, %(created_date_m27)s, %(updated_date_m27)s), (%(customer_id_m28)s, %(year_birth_m28)s, %(age_m28)s, %(education_m28)s, %(marital_status_m28)s, %(income_m28)s, %(kidhome_m28)s, %(teenhome_m28)s, %(dt_customer_m28)s, %(customer_segment_m28)s, %(total_spending_m28)s, %(is_active_m28)s, %(created_date_m28)s, %(updated_date_m28)s), (%(customer_id_m29)s, %(year_birth_m29)s, %(age_m29)s, %(education_m29)s, %(marital_status_m29)s, %(income_m29)s, %(kidhome_m29)s, %(teenhome_m29)s, %(dt_customer_m29)s, %(customer_segment_m29)s, %(total_spending_m29)s, %(is_active_m29)s, %(created_date_m29)s, %(updated_date_m29)s), (%(customer_id_m30)s, %(year_birth_m30)s, %(age_m30)s, %(education_m30)s, %(marital_status_m30)s, %(income_m30)s, %(kidhome_m30)s, %(teenhome_m30)s, %(dt_customer_m30)s, %(customer_segment_m30)s, %(total_spending_m30)s, %(is_active_m30)s, %(created_date_m30)s, %(updated_date_m30)s), (%(customer_id_m31)s, %(year_birth_m31)s, %(age_m31)s, %(education_m31)s, %(marital_status_m31)s, %(income_m31)s, %(kidhome_m31)s, %(teenhome_m31)s, %(dt_customer_m31)s, %(customer_segment_m31)s, %(total_spending_m31)s, %(is_active_m31)s, %(created_date_m31)s, %(updated_date_m31)s), (%(customer_id_m32)s, %(year_birth_m32)s, %(age_m32)s, %(education_m32)s, %(marital_status_m32)s, %(income_m32)s, %(kidhome_m32)s, %(teenhome_m32)s, %(dt_customer_m32)s, %(customer_segment_m32)s, %(total_spending_m32)s, %(is_active_m32)s, %(created_date_m32)s, %(updated_date_m32)s), (%(customer_id_m33)s, %(year_birth_m33)s, %(age_m33)s, %(education_m33)s, %(marital_status_m33)s, %(income_m33)s, %(kidhome_m33)s, %(teenhome_m33)s, %(dt_customer_m33)s, %(customer_segment_m33)s, %(total_spending_m33)s, %(is_active_m33)s, %(created_date_m33)s, %(updated_date_m33)s), (%(customer_id_m34)s, %(year_birth_m34)s, %(age_m34)s, %(education_m34)s, %(marital_status_m34)s, %(income_m34)s, %(kidhome_m34)s, %(teenhome_m34)s, %(dt_customer_m34)s, %(customer_segment_m34)s, %(total_spending_m34)s, %(is_active_m34)s, %(created_date_m34)s, %(updated_date_m34)s), (%(customer_id_m35)s, %(year_birth_m35)s, %(age_m35)s, %(education_m35)s, %(marital_status_m35)s, %(income_m35)s, %(kidhome_m35)s, %(teenhome_m35)s, %(dt_customer_m35)s, %(customer_segment_m35)s, %(total_spending_m35)s, %(is_active_m35)s, %(created_date_m35)s, %(updated_date_m35)s), (%(customer_id_m36)s, %(year_birth_m36)s, %(age_m36)s, %(education_m36)s, %(marital_status_m36)s, %(income_m36)s, %(kidhome_m36)s, %(teenhome_m36)s, %(dt_customer_m36)s, %(customer_segment_m36)s, %(total_spending_m36)s, %(is_active_m36)s, %(created_date_m36)s, %(updated_date_m36)s), (%(customer_id_m37)s, %(year_birth_m37)s, %(age_m37)s, %(education_m37)s, %(marital_status_m37)s, %(income_m37)s, %(kidhome_m37)s, %(teenhome_m37)s, %(dt_customer_m37)s, %(customer_segment_m37)s, %(total_spending_m37)s, %(is_active_m37)s, %(created_date_m37)s, %(updated_date_m37)s), (%(customer_id_m38)s, %(year_birth_m38)s, %(age_m38)s, %(education_m38)s, %(marital_status_m38)s, %(income_m38)s, %(kidhome_m38)s, %(teenhome_m38)s, %(dt_customer_m38)s, %(customer_segment_m38)s, %(total_spending_m38)s, %(is_active_m38)s, %(created_date_m38)s, %(updated_date_m38)s), (%(customer_id_m39)s, %(year_birth_m39)s, %(age_m39)s, %(education_m39)s, %(marital_status_m39)s, %(income_m39)s, %(kidhome_m39)s, %(teenhome_m39)s, %(dt_customer_m39)s, %(customer_segment_m39)s, %(total_spending_m39)s, %(is_active_m39)s, %(created_date_m39)s, %(updated_date_m39)s), (%(customer_id_m40)s, %(year_birth_m40)s, %(age_m40)s, %(education_m40)s, %(marital_status_m40)s, %(income_m40)s, %(kidhome_m40)s, %(teenhome_m40)s, %(dt_customer_m40)s, %(customer_segment_m40)s, %(total_spending_m40)s, %(is_active_m40)s, %(created_date_m40)s, %(updated_date_m40)s), (%(customer_id_m41)s, %(year_birth_m41)s, %(age_m41)s, %(education_m41)s, %(marital_status_m41)s, %(income_m41)s, %(kidhome_m41)s, %(teenhome_m41)s, %(dt_customer_m41)s, %(customer_segment_m41)s, %(total_spending_m41)s, %(is_active_m41)s, %(created_date_m41)s, %(updated_date_m41)s), (%(customer_id_m42)s, %(year_birth_m42)s, %(age_m42)s, %(education_m42)s, %(marital_status_m42)s, %(income_m42)s, %(kidhome_m42)s, %(teenhome_m42)s, %(dt_customer_m42)s, %(customer_segment_m42)s, %(total_spending_m42)s, %(is_active_m42)s, %(created_date_m42)s, %(updated_date_m42)s), (%(customer_id_m43)s, %(year_birth_m43)s, %(age_m43)s, %(education_m43)s, %(marital_status_m43)s, %(income_m43)s, %(kidhome_m43)s, %(teenhome_m43)s, %(dt_customer_m43)s, %(customer_segment_m43)s, %(total_spending_m43)s, %(is_active_m43)s, %(created_date_m43)s, %(updated_date_m43)s), (%(customer_id_m44)s, %(year_birth_m44)s, %(age_m44)s, %(education_m44)s, %(marital_status_m44)s, %(income_m44)s, %(kidhome_m44)s, %(teenhome_m44)s, %(dt_customer_m44)s, %(customer_segment_m44)s, %(total_spending_m44)s, %(is_active_m44)s, %(created_date_m44)s, %(updated_date_m44)s), (%(customer_id_m45)s, %(year_birth_m45)s, %(age_m45)s, %(education_m45)s, %(marital_status_m45)s, %(income_m45)s, %(kidhome_m45)s, %(teenhome_m45)s, %(dt_customer_m45)s, %(customer_segment_m45)s, %(total_spending_m45)s, %(is_active_m45)s, %(created_date_m45)s, %(updated_date_m45)s), (%(customer_id_m46)s, %(year_birth_m46)s, %(age_m46)s, %(education_m46)s, %(marital_status_m46)s, %(income_m46)s, %(kidhome_m46)s, %(teenhome_m46)s, %(dt_customer_m46)s, %(customer_segment_m46)s, %(total_spending_m46)s, %(is_active_m46)s, %(created_date_m46)s, %(updated_date_m46)s), (%(customer_id_m47)s, %(year_birth_m47)s, %(age_m47)s, %(education_m47)s, %(marital_status_m47)s, %(income_m47)s, %(kidhome_m47)s, %(teenhome_m47)s, %(dt_customer_m47)s, %(customer_segment_m47)s, %(total_spending_m47)s, %(is_active_m47)s, %(created_date_m47)s, %(updated_date_m47)s), (%(customer_id_m48)s, %(year_birth_m48)s, %(age_m48)s, %(education_m48)s, %(marital_status_m48)s, %(income_m48)s, %(kidhome_m48)s, %(teenhome_m48)s, %(dt_customer_m48)s, %(customer_segment_m48)s, %(total_spending_m48)s, %(is_active_m48)s, %(created_date_m48)s, %(updated_date_m48)s), (%(customer_id_m49)s, %(year_birth_m49)s, %(age_m49)s, %(education_m49)s, %(marital_status_m49)s, %(income_m49)s, %(kidhome_m49)s, %(teenhome_m49)s, %(dt_customer_m49)s, %(customer_segment_m49)s, %(total_spending_m49)s, %(is_active_m49)s, %(created_date_m49)s, %(updated_date_m49)s)]
[parameters: {'customer_id_m0': 8151, 'year_birth_m0': 1990, 'age_m0': 35.0, 'education_m0': 'Basic', 'marital_status_m0': 'Married', 'income_m0': 24279.0, 'kidhome_m0': 0, 'teenhome_m0': 0, 'dt_customer_m0': datetime.datetime(2012, 12, 29, 0, 0), 'customer_segment_m0': 'Regular', 'total_spending_m0': 263, 'is_active_m0': True, 'created_date_m0': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'updated_date_m0': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'customer_id_m1': 8652, 'year_birth_m1': 1946, 'age_m1': 79.0, 'education_m1': 'Graduation', 'marital_status_m1': 'Together', 'income_m1': 37760.0, 'kidhome_m1': 0, 'teenhome_m1': 0, 'dt_customer_m1': datetime.datetime(2012, 8, 31, 0, 0), 'customer_segment_m1': 'Regular', 'total_spending_m1': 317, 'is_active_m1': True, 'created_date_m1': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'updated_date_m1': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'customer_id_m2': 20, 'year_birth_m2': 1965, 'age_m2': 60.0, 'education_m2': '2n Cycle', 'marital_status_m2': 'Married', 'income_m2': 46891.0, 'kidhome_m2': 0, 'teenhome_m2': 1, 'dt_customer_m2': datetime.datetime(2013, 9, 1, 0, 0), 'customer_segment_m2': 'Regular', 'total_spending_m2': 183, 'is_active_m2': True, 'created_date_m2': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'updated_date_m2': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'customer_id_m3': 4050, 'year_birth_m3': 1966, 'age_m3': 59.0, 'education_m3': 'Master', 'marital_status_m3': 'Married', 'income_m3': 49605.0, 'kidhome_m3': 0, 'teenhome_m3': 0 ... 600 parameters truncated ... 'kidhome_m46': 0, 'teenhome_m46': 1, 'dt_customer_m46': datetime.datetime(2013, 5, 22, 0, 0), 'customer_segment_m46': 'Premium', 'total_spending_m46': 1829, 'is_active_m46': True, 'created_date_m46': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'updated_date_m46': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'customer_id_m47': 1177, 'year_birth_m47': 1966, 'age_m47': 59.0, 'education_m47': 'Master', 'marital_status_m47': 'Together', 'income_m47': 49618.0, 'kidhome_m47': 1, 'teenhome_m47': 1, 'dt_customer_m47': datetime.datetime(2013, 1, 26, 0, 0), 'customer_segment_m47': 'Regular', 'total_spending_m47': 129, 'is_active_m47': True, 'created_date_m47': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'updated_date_m47': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'customer_id_m48': 5955, 'year_birth_m48': 1962, 'age_m48': 63.0, 'education_m48': 'Graduation', 'marital_status_m48': 'Together', 'income_m48': 72025.0, 'kidhome_m48': 0, 'teenhome_m48': 0, 'dt_customer_m48': datetime.datetime(2012, 11, 17, 0, 0), 'customer_segment_m48': 'Premium', 'total_spending_m48': 1932, 'is_active_m48': True, 'created_date_m48': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'updated_date_m48': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'customer_id_m49': 10120, 'year_birth_m49': 1955, 'age_m49': 70.0, 'education_m49': 'Graduation', 'marital_status_m49': 'Together', 'income_m49': 38946.0, 'kidhome_m49': 0, 'teenhome_m49': 1, 'dt_customer_m49': datetime.datetime(2013, 10, 24, 0, 0), 'customer_segment_m49': 'Regular', 'total_spending_m49': 257, 'is_active_m49': True, 'created_date_m49': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'updated_date_m49': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-12-04 10:26:48,763 - etl.load.load_dimensions - ERROR - ======================================================================
2025-12-04 10:26:48,763 - etl.load.load_dimensions - ERROR - [ERROR] DIMENSION LOAD FAILED: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "dim_customer_customer_id_key"
DETAIL:  Key (customer_id)=(8151) already exists.

[SQL: INSERT INTO dim_customer (customer_id, year_birth, age, education, marital_status, income, kidhome, teenhome, dt_customer, customer_segment, total_spending, is_active, created_date, updated_date) VALUES (%(customer_id_m0)s, %(year_birth_m0)s, %(age_m0)s, %(education_m0)s, %(marital_status_m0)s, %(income_m0)s, %(kidhome_m0)s, %(teenhome_m0)s, %(dt_customer_m0)s, %(customer_segment_m0)s, %(total_spending_m0)s, %(is_active_m0)s, %(created_date_m0)s, %(updated_date_m0)s), (%(customer_id_m1)s, %(year_birth_m1)s, %(age_m1)s, %(education_m1)s, %(marital_status_m1)s, %(income_m1)s, %(kidhome_m1)s, %(teenhome_m1)s, %(dt_customer_m1)s, %(customer_segment_m1)s, %(total_spending_m1)s, %(is_active_m1)s, %(created_date_m1)s, %(updated_date_m1)s), (%(customer_id_m2)s, %(year_birth_m2)s, %(age_m2)s, %(education_m2)s, %(marital_status_m2)s, %(income_m2)s, %(kidhome_m2)s, %(teenhome_m2)s, %(dt_customer_m2)s, %(customer_segment_m2)s, %(total_spending_m2)s, %(is_active_m2)s, %(created_date_m2)s, %(updated_date_m2)s), (%(customer_id_m3)s, %(year_birth_m3)s, %(age_m3)s, %(education_m3)s, %(marital_status_m3)s, %(income_m3)s, %(kidhome_m3)s, %(teenhome_m3)s, %(dt_customer_m3)s, %(customer_segment_m3)s, %(total_spending_m3)s, %(is_active_m3)s, %(created_date_m3)s, %(updated_date_m3)s), (%(customer_id_m4)s, %(year_birth_m4)s, %(age_m4)s, %(education_m4)s, %(marital_status_m4)s, %(income_m4)s, %(kidhome_m4)s, %(teenhome_m4)s, %(dt_customer_m4)s, %(customer_segment_m4)s, %(total_spending_m4)s, %(is_active_m4)s, %(created_date_m4)s, %(updated_date_m4)s), (%(customer_id_m5)s, %(year_birth_m5)s, %(age_m5)s, %(education_m5)s, %(marital_status_m5)s, %(income_m5)s, %(kidhome_m5)s, %(teenhome_m5)s, %(dt_customer_m5)s, %(customer_segment_m5)s, %(total_spending_m5)s, %(is_active_m5)s, %(created_date_m5)s, %(updated_date_m5)s), (%(customer_id_m6)s, %(year_birth_m6)s, %(age_m6)s, %(education_m6)s, %(marital_status_m6)s, %(income_m6)s, %(kidhome_m6)s, %(teenhome_m6)s, %(dt_customer_m6)s, %(customer_segment_m6)s, %(total_spending_m6)s, %(is_active_m6)s, %(created_date_m6)s, %(updated_date_m6)s), (%(customer_id_m7)s, %(year_birth_m7)s, %(age_m7)s, %(education_m7)s, %(marital_status_m7)s, %(income_m7)s, %(kidhome_m7)s, %(teenhome_m7)s, %(dt_customer_m7)s, %(customer_segment_m7)s, %(total_spending_m7)s, %(is_active_m7)s, %(created_date_m7)s, %(updated_date_m7)s), (%(customer_id_m8)s, %(year_birth_m8)s, %(age_m8)s, %(education_m8)s, %(marital_status_m8)s, %(income_m8)s, %(kidhome_m8)s, %(teenhome_m8)s, %(dt_customer_m8)s, %(customer_segment_m8)s, %(total_spending_m8)s, %(is_active_m8)s, %(created_date_m8)s, %(updated_date_m8)s), (%(customer_id_m9)s, %(year_birth_m9)s, %(age_m9)s, %(education_m9)s, %(marital_status_m9)s, %(income_m9)s, %(kidhome_m9)s, %(teenhome_m9)s, %(dt_customer_m9)s, %(customer_segment_m9)s, %(total_spending_m9)s, %(is_active_m9)s, %(created_date_m9)s, %(updated_date_m9)s), (%(customer_id_m10)s, %(year_birth_m10)s, %(age_m10)s, %(education_m10)s, %(marital_status_m10)s, %(income_m10)s, %(kidhome_m10)s, %(teenhome_m10)s, %(dt_customer_m10)s, %(customer_segment_m10)s, %(total_spending_m10)s, %(is_active_m10)s, %(created_date_m10)s, %(updated_date_m10)s), (%(customer_id_m11)s, %(year_birth_m11)s, %(age_m11)s, %(education_m11)s, %(marital_status_m11)s, %(income_m11)s, %(kidhome_m11)s, %(teenhome_m11)s, %(dt_customer_m11)s, %(customer_segment_m11)s, %(total_spending_m11)s, %(is_active_m11)s, %(created_date_m11)s, %(updated_date_m11)s), (%(customer_id_m12)s, %(year_birth_m12)s, %(age_m12)s, %(education_m12)s, %(marital_status_m12)s, %(income_m12)s, %(kidhome_m12)s, %(teenhome_m12)s, %(dt_customer_m12)s, %(customer_segment_m12)s, %(total_spending_m12)s, %(is_active_m12)s, %(created_date_m12)s, %(updated_date_m12)s), (%(customer_id_m13)s, %(year_birth_m13)s, %(age_m13)s, %(education_m13)s, %(marital_status_m13)s, %(income_m13)s, %(kidhome_m13)s, %(teenhome_m13)s, %(dt_customer_m13)s, %(customer_segment_m13)s, %(total_spending_m13)s, %(is_active_m13)s, %(created_date_m13)s, %(updated_date_m13)s), (%(customer_id_m14)s, %(year_birth_m14)s, %(age_m14)s, %(education_m14)s, %(marital_status_m14)s, %(income_m14)s, %(kidhome_m14)s, %(teenhome_m14)s, %(dt_customer_m14)s, %(customer_segment_m14)s, %(total_spending_m14)s, %(is_active_m14)s, %(created_date_m14)s, %(updated_date_m14)s), (%(customer_id_m15)s, %(year_birth_m15)s, %(age_m15)s, %(education_m15)s, %(marital_status_m15)s, %(income_m15)s, %(kidhome_m15)s, %(teenhome_m15)s, %(dt_customer_m15)s, %(customer_segment_m15)s, %(total_spending_m15)s, %(is_active_m15)s, %(created_date_m15)s, %(updated_date_m15)s), (%(customer_id_m16)s, %(year_birth_m16)s, %(age_m16)s, %(education_m16)s, %(marital_status_m16)s, %(income_m16)s, %(kidhome_m16)s, %(teenhome_m16)s, %(dt_customer_m16)s, %(customer_segment_m16)s, %(total_spending_m16)s, %(is_active_m16)s, %(created_date_m16)s, %(updated_date_m16)s), (%(customer_id_m17)s, %(year_birth_m17)s, %(age_m17)s, %(education_m17)s, %(marital_status_m17)s, %(income_m17)s, %(kidhome_m17)s, %(teenhome_m17)s, %(dt_customer_m17)s, %(customer_segment_m17)s, %(total_spending_m17)s, %(is_active_m17)s, %(created_date_m17)s, %(updated_date_m17)s), (%(customer_id_m18)s, %(year_birth_m18)s, %(age_m18)s, %(education_m18)s, %(marital_status_m18)s, %(income_m18)s, %(kidhome_m18)s, %(teenhome_m18)s, %(dt_customer_m18)s, %(customer_segment_m18)s, %(total_spending_m18)s, %(is_active_m18)s, %(created_date_m18)s, %(updated_date_m18)s), (%(customer_id_m19)s, %(year_birth_m19)s, %(age_m19)s, %(education_m19)s, %(marital_status_m19)s, %(income_m19)s, %(kidhome_m19)s, %(teenhome_m19)s, %(dt_customer_m19)s, %(customer_segment_m19)s, %(total_spending_m19)s, %(is_active_m19)s, %(created_date_m19)s, %(updated_date_m19)s), (%(customer_id_m20)s, %(year_birth_m20)s, %(age_m20)s, %(education_m20)s, %(marital_status_m20)s, %(income_m20)s, %(kidhome_m20)s, %(teenhome_m20)s, %(dt_customer_m20)s, %(customer_segment_m20)s, %(total_spending_m20)s, %(is_active_m20)s, %(created_date_m20)s, %(updated_date_m20)s), (%(customer_id_m21)s, %(year_birth_m21)s, %(age_m21)s, %(education_m21)s, %(marital_status_m21)s, %(income_m21)s, %(kidhome_m21)s, %(teenhome_m21)s, %(dt_customer_m21)s, %(customer_segment_m21)s, %(total_spending_m21)s, %(is_active_m21)s, %(created_date_m21)s, %(updated_date_m21)s), (%(customer_id_m22)s, %(year_birth_m22)s, %(age_m22)s, %(education_m22)s, %(marital_status_m22)s, %(income_m22)s, %(kidhome_m22)s, %(teenhome_m22)s, %(dt_customer_m22)s, %(customer_segment_m22)s, %(total_spending_m22)s, %(is_active_m22)s, %(created_date_m22)s, %(updated_date_m22)s), (%(customer_id_m23)s, %(year_birth_m23)s, %(age_m23)s, %(education_m23)s, %(marital_status_m23)s, %(income_m23)s, %(kidhome_m23)s, %(teenhome_m23)s, %(dt_customer_m23)s, %(customer_segment_m23)s, %(total_spending_m23)s, %(is_active_m23)s, %(created_date_m23)s, %(updated_date_m23)s), (%(customer_id_m24)s, %(year_birth_m24)s, %(age_m24)s, %(education_m24)s, %(marital_status_m24)s, %(income_m24)s, %(kidhome_m24)s, %(teenhome_m24)s, %(dt_customer_m24)s, %(customer_segment_m24)s, %(total_spending_m24)s, %(is_active_m24)s, %(created_date_m24)s, %(updated_date_m24)s), (%(customer_id_m25)s, %(year_birth_m25)s, %(age_m25)s, %(education_m25)s, %(marital_status_m25)s, %(income_m25)s, %(kidhome_m25)s, %(teenhome_m25)s, %(dt_customer_m25)s, %(customer_segment_m25)s, %(total_spending_m25)s, %(is_active_m25)s, %(created_date_m25)s, %(updated_date_m25)s), (%(customer_id_m26)s, %(year_birth_m26)s, %(age_m26)s, %(education_m26)s, %(marital_status_m26)s, %(income_m26)s, %(kidhome_m26)s, %(teenhome_m26)s, %(dt_customer_m26)s, %(customer_segment_m26)s, %(total_spending_m26)s, %(is_active_m26)s, %(created_date_m26)s, %(updated_date_m26)s), (%(customer_id_m27)s, %(year_birth_m27)s, %(age_m27)s, %(education_m27)s, %(marital_status_m27)s, %(income_m27)s, %(kidhome_m27)s, %(teenhome_m27)s, %(dt_customer_m27)s, %(customer_segment_m27)s, %(total_spending_m27)s, %(is_active_m27)s, %(created_date_m27)s, %(updated_date_m27)s), (%(customer_id_m28)s, %(year_birth_m28)s, %(age_m28)s, %(education_m28)s, %(marital_status_m28)s, %(income_m28)s, %(kidhome_m28)s, %(teenhome_m28)s, %(dt_customer_m28)s, %(customer_segment_m28)s, %(total_spending_m28)s, %(is_active_m28)s, %(created_date_m28)s, %(updated_date_m28)s), (%(customer_id_m29)s, %(year_birth_m29)s, %(age_m29)s, %(education_m29)s, %(marital_status_m29)s, %(income_m29)s, %(kidhome_m29)s, %(teenhome_m29)s, %(dt_customer_m29)s, %(customer_segment_m29)s, %(total_spending_m29)s, %(is_active_m29)s, %(created_date_m29)s, %(updated_date_m29)s), (%(customer_id_m30)s, %(year_birth_m30)s, %(age_m30)s, %(education_m30)s, %(marital_status_m30)s, %(income_m30)s, %(kidhome_m30)s, %(teenhome_m30)s, %(dt_customer_m30)s, %(customer_segment_m30)s, %(total_spending_m30)s, %(is_active_m30)s, %(created_date_m30)s, %(updated_date_m30)s), (%(customer_id_m31)s, %(year_birth_m31)s, %(age_m31)s, %(education_m31)s, %(marital_status_m31)s, %(income_m31)s, %(kidhome_m31)s, %(teenhome_m31)s, %(dt_customer_m31)s, %(customer_segment_m31)s, %(total_spending_m31)s, %(is_active_m31)s, %(created_date_m31)s, %(updated_date_m31)s), (%(customer_id_m32)s, %(year_birth_m32)s, %(age_m32)s, %(education_m32)s, %(marital_status_m32)s, %(income_m32)s, %(kidhome_m32)s, %(teenhome_m32)s, %(dt_customer_m32)s, %(customer_segment_m32)s, %(total_spending_m32)s, %(is_active_m32)s, %(created_date_m32)s, %(updated_date_m32)s), (%(customer_id_m33)s, %(year_birth_m33)s, %(age_m33)s, %(education_m33)s, %(marital_status_m33)s, %(income_m33)s, %(kidhome_m33)s, %(teenhome_m33)s, %(dt_customer_m33)s, %(customer_segment_m33)s, %(total_spending_m33)s, %(is_active_m33)s, %(created_date_m33)s, %(updated_date_m33)s), (%(customer_id_m34)s, %(year_birth_m34)s, %(age_m34)s, %(education_m34)s, %(marital_status_m34)s, %(income_m34)s, %(kidhome_m34)s, %(teenhome_m34)s, %(dt_customer_m34)s, %(customer_segment_m34)s, %(total_spending_m34)s, %(is_active_m34)s, %(created_date_m34)s, %(updated_date_m34)s), (%(customer_id_m35)s, %(year_birth_m35)s, %(age_m35)s, %(education_m35)s, %(marital_status_m35)s, %(income_m35)s, %(kidhome_m35)s, %(teenhome_m35)s, %(dt_customer_m35)s, %(customer_segment_m35)s, %(total_spending_m35)s, %(is_active_m35)s, %(created_date_m35)s, %(updated_date_m35)s), (%(customer_id_m36)s, %(year_birth_m36)s, %(age_m36)s, %(education_m36)s, %(marital_status_m36)s, %(income_m36)s, %(kidhome_m36)s, %(teenhome_m36)s, %(dt_customer_m36)s, %(customer_segment_m36)s, %(total_spending_m36)s, %(is_active_m36)s, %(created_date_m36)s, %(updated_date_m36)s), (%(customer_id_m37)s, %(year_birth_m37)s, %(age_m37)s, %(education_m37)s, %(marital_status_m37)s, %(income_m37)s, %(kidhome_m37)s, %(teenhome_m37)s, %(dt_customer_m37)s, %(customer_segment_m37)s, %(total_spending_m37)s, %(is_active_m37)s, %(created_date_m37)s, %(updated_date_m37)s), (%(customer_id_m38)s, %(year_birth_m38)s, %(age_m38)s, %(education_m38)s, %(marital_status_m38)s, %(income_m38)s, %(kidhome_m38)s, %(teenhome_m38)s, %(dt_customer_m38)s, %(customer_segment_m38)s, %(total_spending_m38)s, %(is_active_m38)s, %(created_date_m38)s, %(updated_date_m38)s), (%(customer_id_m39)s, %(year_birth_m39)s, %(age_m39)s, %(education_m39)s, %(marital_status_m39)s, %(income_m39)s, %(kidhome_m39)s, %(teenhome_m39)s, %(dt_customer_m39)s, %(customer_segment_m39)s, %(total_spending_m39)s, %(is_active_m39)s, %(created_date_m39)s, %(updated_date_m39)s), (%(customer_id_m40)s, %(year_birth_m40)s, %(age_m40)s, %(education_m40)s, %(marital_status_m40)s, %(income_m40)s, %(kidhome_m40)s, %(teenhome_m40)s, %(dt_customer_m40)s, %(customer_segment_m40)s, %(total_spending_m40)s, %(is_active_m40)s, %(created_date_m40)s, %(updated_date_m40)s), (%(customer_id_m41)s, %(year_birth_m41)s, %(age_m41)s, %(education_m41)s, %(marital_status_m41)s, %(income_m41)s, %(kidhome_m41)s, %(teenhome_m41)s, %(dt_customer_m41)s, %(customer_segment_m41)s, %(total_spending_m41)s, %(is_active_m41)s, %(created_date_m41)s, %(updated_date_m41)s), (%(customer_id_m42)s, %(year_birth_m42)s, %(age_m42)s, %(education_m42)s, %(marital_status_m42)s, %(income_m42)s, %(kidhome_m42)s, %(teenhome_m42)s, %(dt_customer_m42)s, %(customer_segment_m42)s, %(total_spending_m42)s, %(is_active_m42)s, %(created_date_m42)s, %(updated_date_m42)s), (%(customer_id_m43)s, %(year_birth_m43)s, %(age_m43)s, %(education_m43)s, %(marital_status_m43)s, %(income_m43)s, %(kidhome_m43)s, %(teenhome_m43)s, %(dt_customer_m43)s, %(customer_segment_m43)s, %(total_spending_m43)s, %(is_active_m43)s, %(created_date_m43)s, %(updated_date_m43)s), (%(customer_id_m44)s, %(year_birth_m44)s, %(age_m44)s, %(education_m44)s, %(marital_status_m44)s, %(income_m44)s, %(kidhome_m44)s, %(teenhome_m44)s, %(dt_customer_m44)s, %(customer_segment_m44)s, %(total_spending_m44)s, %(is_active_m44)s, %(created_date_m44)s, %(updated_date_m44)s), (%(customer_id_m45)s, %(year_birth_m45)s, %(age_m45)s, %(education_m45)s, %(marital_status_m45)s, %(income_m45)s, %(kidhome_m45)s, %(teenhome_m45)s, %(dt_customer_m45)s, %(customer_segment_m45)s, %(total_spending_m45)s, %(is_active_m45)s, %(created_date_m45)s, %(updated_date_m45)s), (%(customer_id_m46)s, %(year_birth_m46)s, %(age_m46)s, %(education_m46)s, %(marital_status_m46)s, %(income_m46)s, %(kidhome_m46)s, %(teenhome_m46)s, %(dt_customer_m46)s, %(customer_segment_m46)s, %(total_spending_m46)s, %(is_active_m46)s, %(created_date_m46)s, %(updated_date_m46)s), (%(customer_id_m47)s, %(year_birth_m47)s, %(age_m47)s, %(education_m47)s, %(marital_status_m47)s, %(income_m47)s, %(kidhome_m47)s, %(teenhome_m47)s, %(dt_customer_m47)s, %(customer_segment_m47)s, %(total_spending_m47)s, %(is_active_m47)s, %(created_date_m47)s, %(updated_date_m47)s), (%(customer_id_m48)s, %(year_birth_m48)s, %(age_m48)s, %(education_m48)s, %(marital_status_m48)s, %(income_m48)s, %(kidhome_m48)s, %(teenhome_m48)s, %(dt_customer_m48)s, %(customer_segment_m48)s, %(total_spending_m48)s, %(is_active_m48)s, %(created_date_m48)s, %(updated_date_m48)s), (%(customer_id_m49)s, %(year_birth_m49)s, %(age_m49)s, %(education_m49)s, %(marital_status_m49)s, %(income_m49)s, %(kidhome_m49)s, %(teenhome_m49)s, %(dt_customer_m49)s, %(customer_segment_m49)s, %(total_spending_m49)s, %(is_active_m49)s, %(created_date_m49)s, %(updated_date_m49)s)]
[parameters: {'customer_id_m0': 8151, 'year_birth_m0': 1990, 'age_m0': 35.0, 'education_m0': 'Basic', 'marital_status_m0': 'Married', 'income_m0': 24279.0, 'kidhome_m0': 0, 'teenhome_m0': 0, 'dt_customer_m0': datetime.datetime(2012, 12, 29, 0, 0), 'customer_segment_m0': 'Regular', 'total_spending_m0': 263, 'is_active_m0': True, 'created_date_m0': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'updated_date_m0': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'customer_id_m1': 8652, 'year_birth_m1': 1946, 'age_m1': 79.0, 'education_m1': 'Graduation', 'marital_status_m1': 'Together', 'income_m1': 37760.0, 'kidhome_m1': 0, 'teenhome_m1': 0, 'dt_customer_m1': datetime.datetime(2012, 8, 31, 0, 0), 'customer_segment_m1': 'Regular', 'total_spending_m1': 317, 'is_active_m1': True, 'created_date_m1': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'updated_date_m1': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'customer_id_m2': 20, 'year_birth_m2': 1965, 'age_m2': 60.0, 'education_m2': '2n Cycle', 'marital_status_m2': 'Married', 'income_m2': 46891.0, 'kidhome_m2': 0, 'teenhome_m2': 1, 'dt_customer_m2': datetime.datetime(2013, 9, 1, 0, 0), 'customer_segment_m2': 'Regular', 'total_spending_m2': 183, 'is_active_m2': True, 'created_date_m2': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'updated_date_m2': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'customer_id_m3': 4050, 'year_birth_m3': 1966, 'age_m3': 59.0, 'education_m3': 'Master', 'marital_status_m3': 'Married', 'income_m3': 49605.0, 'kidhome_m3': 0, 'teenhome_m3': 0 ... 600 parameters truncated ... 'kidhome_m46': 0, 'teenhome_m46': 1, 'dt_customer_m46': datetime.datetime(2013, 5, 22, 0, 0), 'customer_segment_m46': 'Premium', 'total_spending_m46': 1829, 'is_active_m46': True, 'created_date_m46': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'updated_date_m46': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'customer_id_m47': 1177, 'year_birth_m47': 1966, 'age_m47': 59.0, 'education_m47': 'Master', 'marital_status_m47': 'Together', 'income_m47': 49618.0, 'kidhome_m47': 1, 'teenhome_m47': 1, 'dt_customer_m47': datetime.datetime(2013, 1, 26, 0, 0), 'customer_segment_m47': 'Regular', 'total_spending_m47': 129, 'is_active_m47': True, 'created_date_m47': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'updated_date_m47': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'customer_id_m48': 5955, 'year_birth_m48': 1962, 'age_m48': 63.0, 'education_m48': 'Graduation', 'marital_status_m48': 'Together', 'income_m48': 72025.0, 'kidhome_m48': 0, 'teenhome_m48': 0, 'dt_customer_m48': datetime.datetime(2012, 11, 17, 0, 0), 'customer_segment_m48': 'Premium', 'total_spending_m48': 1932, 'is_active_m48': True, 'created_date_m48': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'updated_date_m48': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'customer_id_m49': 10120, 'year_birth_m49': 1955, 'age_m49': 70.0, 'education_m49': 'Graduation', 'marital_status_m49': 'Together', 'income_m49': 38946.0, 'kidhome_m49': 0, 'teenhome_m49': 1, 'dt_customer_m49': datetime.datetime(2013, 10, 24, 0, 0), 'customer_segment_m49': 'Regular', 'total_spending_m49': 257, 'is_active_m49': True, 'created_date_m49': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'updated_date_m49': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-12-04 10:26:48,771 - etl.load.load_dimensions - ERROR - ======================================================================
2025-12-04 10:26:48,780 - etl.load.load_dimensions - ERROR - Traceback (most recent call last):
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "dim_customer_customer_id_key"
DETAIL:  Key (customer_id)=(8151) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\FILE SM 5\nourish-beauty-dwh-uiux\etl\load\load_dimensions.py", line 234, in load_all_dimensions
    load_dim_customer()
  File "D:\FILE SM 5\nourish-beauty-dwh-uiux\etl\load\load_dimensions.py", line 122, in load_dim_customer
    chunk.to_sql('dim_customer', conn, if_exists='append', index=False, method='multi')
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\generic.py", line 3106, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 2030, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1579, in insert_records
    raise err
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1570, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1121, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1029, in _execute_insert_multi
    result = conn.execute(stmt)
             ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\Asus\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "dim_customer_customer_id_key"
DETAIL:  Key (customer_id)=(8151) already exists.

[SQL: INSERT INTO dim_customer (customer_id, year_birth, age, education, marital_status, income, kidhome, teenhome, dt_customer, customer_segment, total_spending, is_active, created_date, updated_date) VALUES (%(customer_id_m0)s, %(year_birth_m0)s, %(age_m0)s, %(education_m0)s, %(marital_status_m0)s, %(income_m0)s, %(kidhome_m0)s, %(teenhome_m0)s, %(dt_customer_m0)s, %(customer_segment_m0)s, %(total_spending_m0)s, %(is_active_m0)s, %(created_date_m0)s, %(updated_date_m0)s), (%(customer_id_m1)s, %(year_birth_m1)s, %(age_m1)s, %(education_m1)s, %(marital_status_m1)s, %(income_m1)s, %(kidhome_m1)s, %(teenhome_m1)s, %(dt_customer_m1)s, %(customer_segment_m1)s, %(total_spending_m1)s, %(is_active_m1)s, %(created_date_m1)s, %(updated_date_m1)s), (%(customer_id_m2)s, %(year_birth_m2)s, %(age_m2)s, %(education_m2)s, %(marital_status_m2)s, %(income_m2)s, %(kidhome_m2)s, %(teenhome_m2)s, %(dt_customer_m2)s, %(customer_segment_m2)s, %(total_spending_m2)s, %(is_active_m2)s, %(created_date_m2)s, %(updated_date_m2)s), (%(customer_id_m3)s, %(year_birth_m3)s, %(age_m3)s, %(education_m3)s, %(marital_status_m3)s, %(income_m3)s, %(kidhome_m3)s, %(teenhome_m3)s, %(dt_customer_m3)s, %(customer_segment_m3)s, %(total_spending_m3)s, %(is_active_m3)s, %(created_date_m3)s, %(updated_date_m3)s), (%(customer_id_m4)s, %(year_birth_m4)s, %(age_m4)s, %(education_m4)s, %(marital_status_m4)s, %(income_m4)s, %(kidhome_m4)s, %(teenhome_m4)s, %(dt_customer_m4)s, %(customer_segment_m4)s, %(total_spending_m4)s, %(is_active_m4)s, %(created_date_m4)s, %(updated_date_m4)s), (%(customer_id_m5)s, %(year_birth_m5)s, %(age_m5)s, %(education_m5)s, %(marital_status_m5)s, %(income_m5)s, %(kidhome_m5)s, %(teenhome_m5)s, %(dt_customer_m5)s, %(customer_segment_m5)s, %(total_spending_m5)s, %(is_active_m5)s, %(created_date_m5)s, %(updated_date_m5)s), (%(customer_id_m6)s, %(year_birth_m6)s, %(age_m6)s, %(education_m6)s, %(marital_status_m6)s, %(income_m6)s, %(kidhome_m6)s, %(teenhome_m6)s, %(dt_customer_m6)s, %(customer_segment_m6)s, %(total_spending_m6)s, %(is_active_m6)s, %(created_date_m6)s, %(updated_date_m6)s), (%(customer_id_m7)s, %(year_birth_m7)s, %(age_m7)s, %(education_m7)s, %(marital_status_m7)s, %(income_m7)s, %(kidhome_m7)s, %(teenhome_m7)s, %(dt_customer_m7)s, %(customer_segment_m7)s, %(total_spending_m7)s, %(is_active_m7)s, %(created_date_m7)s, %(updated_date_m7)s), (%(customer_id_m8)s, %(year_birth_m8)s, %(age_m8)s, %(education_m8)s, %(marital_status_m8)s, %(income_m8)s, %(kidhome_m8)s, %(teenhome_m8)s, %(dt_customer_m8)s, %(customer_segment_m8)s, %(total_spending_m8)s, %(is_active_m8)s, %(created_date_m8)s, %(updated_date_m8)s), (%(customer_id_m9)s, %(year_birth_m9)s, %(age_m9)s, %(education_m9)s, %(marital_status_m9)s, %(income_m9)s, %(kidhome_m9)s, %(teenhome_m9)s, %(dt_customer_m9)s, %(customer_segment_m9)s, %(total_spending_m9)s, %(is_active_m9)s, %(created_date_m9)s, %(updated_date_m9)s), (%(customer_id_m10)s, %(year_birth_m10)s, %(age_m10)s, %(education_m10)s, %(marital_status_m10)s, %(income_m10)s, %(kidhome_m10)s, %(teenhome_m10)s, %(dt_customer_m10)s, %(customer_segment_m10)s, %(total_spending_m10)s, %(is_active_m10)s, %(created_date_m10)s, %(updated_date_m10)s), (%(customer_id_m11)s, %(year_birth_m11)s, %(age_m11)s, %(education_m11)s, %(marital_status_m11)s, %(income_m11)s, %(kidhome_m11)s, %(teenhome_m11)s, %(dt_customer_m11)s, %(customer_segment_m11)s, %(total_spending_m11)s, %(is_active_m11)s, %(created_date_m11)s, %(updated_date_m11)s), (%(customer_id_m12)s, %(year_birth_m12)s, %(age_m12)s, %(education_m12)s, %(marital_status_m12)s, %(income_m12)s, %(kidhome_m12)s, %(teenhome_m12)s, %(dt_customer_m12)s, %(customer_segment_m12)s, %(total_spending_m12)s, %(is_active_m12)s, %(created_date_m12)s, %(updated_date_m12)s), (%(customer_id_m13)s, %(year_birth_m13)s, %(age_m13)s, %(education_m13)s, %(marital_status_m13)s, %(income_m13)s, %(kidhome_m13)s, %(teenhome_m13)s, %(dt_customer_m13)s, %(customer_segment_m13)s, %(total_spending_m13)s, %(is_active_m13)s, %(created_date_m13)s, %(updated_date_m13)s), (%(customer_id_m14)s, %(year_birth_m14)s, %(age_m14)s, %(education_m14)s, %(marital_status_m14)s, %(income_m14)s, %(kidhome_m14)s, %(teenhome_m14)s, %(dt_customer_m14)s, %(customer_segment_m14)s, %(total_spending_m14)s, %(is_active_m14)s, %(created_date_m14)s, %(updated_date_m14)s), (%(customer_id_m15)s, %(year_birth_m15)s, %(age_m15)s, %(education_m15)s, %(marital_status_m15)s, %(income_m15)s, %(kidhome_m15)s, %(teenhome_m15)s, %(dt_customer_m15)s, %(customer_segment_m15)s, %(total_spending_m15)s, %(is_active_m15)s, %(created_date_m15)s, %(updated_date_m15)s), (%(customer_id_m16)s, %(year_birth_m16)s, %(age_m16)s, %(education_m16)s, %(marital_status_m16)s, %(income_m16)s, %(kidhome_m16)s, %(teenhome_m16)s, %(dt_customer_m16)s, %(customer_segment_m16)s, %(total_spending_m16)s, %(is_active_m16)s, %(created_date_m16)s, %(updated_date_m16)s), (%(customer_id_m17)s, %(year_birth_m17)s, %(age_m17)s, %(education_m17)s, %(marital_status_m17)s, %(income_m17)s, %(kidhome_m17)s, %(teenhome_m17)s, %(dt_customer_m17)s, %(customer_segment_m17)s, %(total_spending_m17)s, %(is_active_m17)s, %(created_date_m17)s, %(updated_date_m17)s), (%(customer_id_m18)s, %(year_birth_m18)s, %(age_m18)s, %(education_m18)s, %(marital_status_m18)s, %(income_m18)s, %(kidhome_m18)s, %(teenhome_m18)s, %(dt_customer_m18)s, %(customer_segment_m18)s, %(total_spending_m18)s, %(is_active_m18)s, %(created_date_m18)s, %(updated_date_m18)s), (%(customer_id_m19)s, %(year_birth_m19)s, %(age_m19)s, %(education_m19)s, %(marital_status_m19)s, %(income_m19)s, %(kidhome_m19)s, %(teenhome_m19)s, %(dt_customer_m19)s, %(customer_segment_m19)s, %(total_spending_m19)s, %(is_active_m19)s, %(created_date_m19)s, %(updated_date_m19)s), (%(customer_id_m20)s, %(year_birth_m20)s, %(age_m20)s, %(education_m20)s, %(marital_status_m20)s, %(income_m20)s, %(kidhome_m20)s, %(teenhome_m20)s, %(dt_customer_m20)s, %(customer_segment_m20)s, %(total_spending_m20)s, %(is_active_m20)s, %(created_date_m20)s, %(updated_date_m20)s), (%(customer_id_m21)s, %(year_birth_m21)s, %(age_m21)s, %(education_m21)s, %(marital_status_m21)s, %(income_m21)s, %(kidhome_m21)s, %(teenhome_m21)s, %(dt_customer_m21)s, %(customer_segment_m21)s, %(total_spending_m21)s, %(is_active_m21)s, %(created_date_m21)s, %(updated_date_m21)s), (%(customer_id_m22)s, %(year_birth_m22)s, %(age_m22)s, %(education_m22)s, %(marital_status_m22)s, %(income_m22)s, %(kidhome_m22)s, %(teenhome_m22)s, %(dt_customer_m22)s, %(customer_segment_m22)s, %(total_spending_m22)s, %(is_active_m22)s, %(created_date_m22)s, %(updated_date_m22)s), (%(customer_id_m23)s, %(year_birth_m23)s, %(age_m23)s, %(education_m23)s, %(marital_status_m23)s, %(income_m23)s, %(kidhome_m23)s, %(teenhome_m23)s, %(dt_customer_m23)s, %(customer_segment_m23)s, %(total_spending_m23)s, %(is_active_m23)s, %(created_date_m23)s, %(updated_date_m23)s), (%(customer_id_m24)s, %(year_birth_m24)s, %(age_m24)s, %(education_m24)s, %(marital_status_m24)s, %(income_m24)s, %(kidhome_m24)s, %(teenhome_m24)s, %(dt_customer_m24)s, %(customer_segment_m24)s, %(total_spending_m24)s, %(is_active_m24)s, %(created_date_m24)s, %(updated_date_m24)s), (%(customer_id_m25)s, %(year_birth_m25)s, %(age_m25)s, %(education_m25)s, %(marital_status_m25)s, %(income_m25)s, %(kidhome_m25)s, %(teenhome_m25)s, %(dt_customer_m25)s, %(customer_segment_m25)s, %(total_spending_m25)s, %(is_active_m25)s, %(created_date_m25)s, %(updated_date_m25)s), (%(customer_id_m26)s, %(year_birth_m26)s, %(age_m26)s, %(education_m26)s, %(marital_status_m26)s, %(income_m26)s, %(kidhome_m26)s, %(teenhome_m26)s, %(dt_customer_m26)s, %(customer_segment_m26)s, %(total_spending_m26)s, %(is_active_m26)s, %(created_date_m26)s, %(updated_date_m26)s), (%(customer_id_m27)s, %(year_birth_m27)s, %(age_m27)s, %(education_m27)s, %(marital_status_m27)s, %(income_m27)s, %(kidhome_m27)s, %(teenhome_m27)s, %(dt_customer_m27)s, %(customer_segment_m27)s, %(total_spending_m27)s, %(is_active_m27)s, %(created_date_m27)s, %(updated_date_m27)s), (%(customer_id_m28)s, %(year_birth_m28)s, %(age_m28)s, %(education_m28)s, %(marital_status_m28)s, %(income_m28)s, %(kidhome_m28)s, %(teenhome_m28)s, %(dt_customer_m28)s, %(customer_segment_m28)s, %(total_spending_m28)s, %(is_active_m28)s, %(created_date_m28)s, %(updated_date_m28)s), (%(customer_id_m29)s, %(year_birth_m29)s, %(age_m29)s, %(education_m29)s, %(marital_status_m29)s, %(income_m29)s, %(kidhome_m29)s, %(teenhome_m29)s, %(dt_customer_m29)s, %(customer_segment_m29)s, %(total_spending_m29)s, %(is_active_m29)s, %(created_date_m29)s, %(updated_date_m29)s), (%(customer_id_m30)s, %(year_birth_m30)s, %(age_m30)s, %(education_m30)s, %(marital_status_m30)s, %(income_m30)s, %(kidhome_m30)s, %(teenhome_m30)s, %(dt_customer_m30)s, %(customer_segment_m30)s, %(total_spending_m30)s, %(is_active_m30)s, %(created_date_m30)s, %(updated_date_m30)s), (%(customer_id_m31)s, %(year_birth_m31)s, %(age_m31)s, %(education_m31)s, %(marital_status_m31)s, %(income_m31)s, %(kidhome_m31)s, %(teenhome_m31)s, %(dt_customer_m31)s, %(customer_segment_m31)s, %(total_spending_m31)s, %(is_active_m31)s, %(created_date_m31)s, %(updated_date_m31)s), (%(customer_id_m32)s, %(year_birth_m32)s, %(age_m32)s, %(education_m32)s, %(marital_status_m32)s, %(income_m32)s, %(kidhome_m32)s, %(teenhome_m32)s, %(dt_customer_m32)s, %(customer_segment_m32)s, %(total_spending_m32)s, %(is_active_m32)s, %(created_date_m32)s, %(updated_date_m32)s), (%(customer_id_m33)s, %(year_birth_m33)s, %(age_m33)s, %(education_m33)s, %(marital_status_m33)s, %(income_m33)s, %(kidhome_m33)s, %(teenhome_m33)s, %(dt_customer_m33)s, %(customer_segment_m33)s, %(total_spending_m33)s, %(is_active_m33)s, %(created_date_m33)s, %(updated_date_m33)s), (%(customer_id_m34)s, %(year_birth_m34)s, %(age_m34)s, %(education_m34)s, %(marital_status_m34)s, %(income_m34)s, %(kidhome_m34)s, %(teenhome_m34)s, %(dt_customer_m34)s, %(customer_segment_m34)s, %(total_spending_m34)s, %(is_active_m34)s, %(created_date_m34)s, %(updated_date_m34)s), (%(customer_id_m35)s, %(year_birth_m35)s, %(age_m35)s, %(education_m35)s, %(marital_status_m35)s, %(income_m35)s, %(kidhome_m35)s, %(teenhome_m35)s, %(dt_customer_m35)s, %(customer_segment_m35)s, %(total_spending_m35)s, %(is_active_m35)s, %(created_date_m35)s, %(updated_date_m35)s), (%(customer_id_m36)s, %(year_birth_m36)s, %(age_m36)s, %(education_m36)s, %(marital_status_m36)s, %(income_m36)s, %(kidhome_m36)s, %(teenhome_m36)s, %(dt_customer_m36)s, %(customer_segment_m36)s, %(total_spending_m36)s, %(is_active_m36)s, %(created_date_m36)s, %(updated_date_m36)s), (%(customer_id_m37)s, %(year_birth_m37)s, %(age_m37)s, %(education_m37)s, %(marital_status_m37)s, %(income_m37)s, %(kidhome_m37)s, %(teenhome_m37)s, %(dt_customer_m37)s, %(customer_segment_m37)s, %(total_spending_m37)s, %(is_active_m37)s, %(created_date_m37)s, %(updated_date_m37)s), (%(customer_id_m38)s, %(year_birth_m38)s, %(age_m38)s, %(education_m38)s, %(marital_status_m38)s, %(income_m38)s, %(kidhome_m38)s, %(teenhome_m38)s, %(dt_customer_m38)s, %(customer_segment_m38)s, %(total_spending_m38)s, %(is_active_m38)s, %(created_date_m38)s, %(updated_date_m38)s), (%(customer_id_m39)s, %(year_birth_m39)s, %(age_m39)s, %(education_m39)s, %(marital_status_m39)s, %(income_m39)s, %(kidhome_m39)s, %(teenhome_m39)s, %(dt_customer_m39)s, %(customer_segment_m39)s, %(total_spending_m39)s, %(is_active_m39)s, %(created_date_m39)s, %(updated_date_m39)s), (%(customer_id_m40)s, %(year_birth_m40)s, %(age_m40)s, %(education_m40)s, %(marital_status_m40)s, %(income_m40)s, %(kidhome_m40)s, %(teenhome_m40)s, %(dt_customer_m40)s, %(customer_segment_m40)s, %(total_spending_m40)s, %(is_active_m40)s, %(created_date_m40)s, %(updated_date_m40)s), (%(customer_id_m41)s, %(year_birth_m41)s, %(age_m41)s, %(education_m41)s, %(marital_status_m41)s, %(income_m41)s, %(kidhome_m41)s, %(teenhome_m41)s, %(dt_customer_m41)s, %(customer_segment_m41)s, %(total_spending_m41)s, %(is_active_m41)s, %(created_date_m41)s, %(updated_date_m41)s), (%(customer_id_m42)s, %(year_birth_m42)s, %(age_m42)s, %(education_m42)s, %(marital_status_m42)s, %(income_m42)s, %(kidhome_m42)s, %(teenhome_m42)s, %(dt_customer_m42)s, %(customer_segment_m42)s, %(total_spending_m42)s, %(is_active_m42)s, %(created_date_m42)s, %(updated_date_m42)s), (%(customer_id_m43)s, %(year_birth_m43)s, %(age_m43)s, %(education_m43)s, %(marital_status_m43)s, %(income_m43)s, %(kidhome_m43)s, %(teenhome_m43)s, %(dt_customer_m43)s, %(customer_segment_m43)s, %(total_spending_m43)s, %(is_active_m43)s, %(created_date_m43)s, %(updated_date_m43)s), (%(customer_id_m44)s, %(year_birth_m44)s, %(age_m44)s, %(education_m44)s, %(marital_status_m44)s, %(income_m44)s, %(kidhome_m44)s, %(teenhome_m44)s, %(dt_customer_m44)s, %(customer_segment_m44)s, %(total_spending_m44)s, %(is_active_m44)s, %(created_date_m44)s, %(updated_date_m44)s), (%(customer_id_m45)s, %(year_birth_m45)s, %(age_m45)s, %(education_m45)s, %(marital_status_m45)s, %(income_m45)s, %(kidhome_m45)s, %(teenhome_m45)s, %(dt_customer_m45)s, %(customer_segment_m45)s, %(total_spending_m45)s, %(is_active_m45)s, %(created_date_m45)s, %(updated_date_m45)s), (%(customer_id_m46)s, %(year_birth_m46)s, %(age_m46)s, %(education_m46)s, %(marital_status_m46)s, %(income_m46)s, %(kidhome_m46)s, %(teenhome_m46)s, %(dt_customer_m46)s, %(customer_segment_m46)s, %(total_spending_m46)s, %(is_active_m46)s, %(created_date_m46)s, %(updated_date_m46)s), (%(customer_id_m47)s, %(year_birth_m47)s, %(age_m47)s, %(education_m47)s, %(marital_status_m47)s, %(income_m47)s, %(kidhome_m47)s, %(teenhome_m47)s, %(dt_customer_m47)s, %(customer_segment_m47)s, %(total_spending_m47)s, %(is_active_m47)s, %(created_date_m47)s, %(updated_date_m47)s), (%(customer_id_m48)s, %(year_birth_m48)s, %(age_m48)s, %(education_m48)s, %(marital_status_m48)s, %(income_m48)s, %(kidhome_m48)s, %(teenhome_m48)s, %(dt_customer_m48)s, %(customer_segment_m48)s, %(total_spending_m48)s, %(is_active_m48)s, %(created_date_m48)s, %(updated_date_m48)s), (%(customer_id_m49)s, %(year_birth_m49)s, %(age_m49)s, %(education_m49)s, %(marital_status_m49)s, %(income_m49)s, %(kidhome_m49)s, %(teenhome_m49)s, %(dt_customer_m49)s, %(customer_segment_m49)s, %(total_spending_m49)s, %(is_active_m49)s, %(created_date_m49)s, %(updated_date_m49)s)]
[parameters: {'customer_id_m0': 8151, 'year_birth_m0': 1990, 'age_m0': 35.0, 'education_m0': 'Basic', 'marital_status_m0': 'Married', 'income_m0': 24279.0, 'kidhome_m0': 0, 'teenhome_m0': 0, 'dt_customer_m0': datetime.datetime(2012, 12, 29, 0, 0), 'customer_segment_m0': 'Regular', 'total_spending_m0': 263, 'is_active_m0': True, 'created_date_m0': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'updated_date_m0': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'customer_id_m1': 8652, 'year_birth_m1': 1946, 'age_m1': 79.0, 'education_m1': 'Graduation', 'marital_status_m1': 'Together', 'income_m1': 37760.0, 'kidhome_m1': 0, 'teenhome_m1': 0, 'dt_customer_m1': datetime.datetime(2012, 8, 31, 0, 0), 'customer_segment_m1': 'Regular', 'total_spending_m1': 317, 'is_active_m1': True, 'created_date_m1': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'updated_date_m1': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'customer_id_m2': 20, 'year_birth_m2': 1965, 'age_m2': 60.0, 'education_m2': '2n Cycle', 'marital_status_m2': 'Married', 'income_m2': 46891.0, 'kidhome_m2': 0, 'teenhome_m2': 1, 'dt_customer_m2': datetime.datetime(2013, 9, 1, 0, 0), 'customer_segment_m2': 'Regular', 'total_spending_m2': 183, 'is_active_m2': True, 'created_date_m2': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'updated_date_m2': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'customer_id_m3': 4050, 'year_birth_m3': 1966, 'age_m3': 59.0, 'education_m3': 'Master', 'marital_status_m3': 'Married', 'income_m3': 49605.0, 'kidhome_m3': 0, 'teenhome_m3': 0 ... 600 parameters truncated ... 'kidhome_m46': 0, 'teenhome_m46': 1, 'dt_customer_m46': datetime.datetime(2013, 5, 22, 0, 0), 'customer_segment_m46': 'Premium', 'total_spending_m46': 1829, 'is_active_m46': True, 'created_date_m46': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'updated_date_m46': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'customer_id_m47': 1177, 'year_birth_m47': 1966, 'age_m47': 59.0, 'education_m47': 'Master', 'marital_status_m47': 'Together', 'income_m47': 49618.0, 'kidhome_m47': 1, 'teenhome_m47': 1, 'dt_customer_m47': datetime.datetime(2013, 1, 26, 0, 0), 'customer_segment_m47': 'Regular', 'total_spending_m47': 129, 'is_active_m47': True, 'created_date_m47': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'updated_date_m47': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'customer_id_m48': 5955, 'year_birth_m48': 1962, 'age_m48': 63.0, 'education_m48': 'Graduation', 'marital_status_m48': 'Together', 'income_m48': 72025.0, 'kidhome_m48': 0, 'teenhome_m48': 0, 'dt_customer_m48': datetime.datetime(2012, 11, 17, 0, 0), 'customer_segment_m48': 'Premium', 'total_spending_m48': 1932, 'is_active_m48': True, 'created_date_m48': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'updated_date_m48': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'customer_id_m49': 10120, 'year_birth_m49': 1955, 'age_m49': 70.0, 'education_m49': 'Graduation', 'marital_status_m49': 'Together', 'income_m49': 38946.0, 'kidhome_m49': 0, 'teenhome_m49': 1, 'dt_customer_m49': datetime.datetime(2013, 10, 24, 0, 0), 'customer_segment_m49': 'Regular', 'total_spending_m49': 257, 'is_active_m49': True, 'created_date_m49': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc), 'updated_date_m49': datetime.datetime(2025, 12, 4, 2, 26, 48, 731407, tzinfo=datetime.timezone.utc)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-12-04 10:26:48,786 - __main__ - INFO - 
2025-12-04 10:26:48,786 - __main__ - INFO - STEP 5: LOAD FACT TABLES
2025-12-04 10:26:48,786 - __main__ - INFO - --------------------------------------------------------------------------------
2025-12-04 10:26:48,814 - etl.load.load_facts - INFO - ======================================================================
2025-12-04 10:26:48,814 - etl.load.load_facts - INFO - STARTING FACT TABLES LOAD PROCESS
2025-12-04 10:26:48,814 - etl.load.load_facts - INFO - ======================================================================
2025-12-04 10:26:48,814 - etl.load.load_facts - INFO - Loading fact_sales...
2025-12-04 10:26:48,896 - etl.load.load_facts - INFO - [OK] Loaded 664 rows to fact_sales
2025-12-04 10:26:48,896 - etl.load.load_facts - INFO - Loading fact_marketing_response...
2025-12-04 10:26:49,055 - etl.load.load_facts - INFO - [OK] Loaded 0 rows to fact_marketing_response
2025-12-04 10:26:49,055 - etl.load.load_facts - INFO - Loading fact_employee_performance...
2025-12-04 10:26:49,099 - etl.load.load_facts - WARNING - No data in dim_employee, skipping fact_employee_performance
2025-12-04 10:26:49,100 - etl.load.load_facts - INFO - Verifying fact tables...
2025-12-04 10:26:49,159 - etl.load.load_facts - INFO - ======================================================================
2025-12-04 10:26:49,159 - etl.load.load_facts - INFO - [OK] ALL FACT TABLES LOADED SUCCESSFULLY!
2025-12-04 10:26:49,159 - etl.load.load_facts - INFO - Total time: 0.34 seconds
2025-12-04 10:26:49,159 - etl.load.load_facts - INFO - ======================================================================
2025-12-04 10:26:49,159 - __main__ - INFO - 
2025-12-04 10:26:49,159 - __main__ - INFO - STEP 6: DATA VERIFICATION
2025-12-04 10:26:49,159 - __main__ - INFO - --------------------------------------------------------------------------------
2025-12-04 10:26:49,210 - __main__ - INFO - 
Data Warehouse Row Counts:
2025-12-04 10:26:49,211 - __main__ - INFO - 
               table_name  row_count
               dim_cabang          6
             dim_customer       1000
             dim_employee          0
              dim_payment          6
               dim_produk          6
              dim_tanggal       4748
fact_employee_performance          0
  fact_marketing_response          0
               fact_sales        664
2025-12-04 10:26:49,211 - __main__ - INFO - 
2025-12-04 10:26:49,211 - __main__ - INFO - ================================================================================
2025-12-04 10:26:49,211 - __main__ - INFO - [OK] ETL PIPELINE COMPLETED SUCCESSFULLY!
2025-12-04 10:26:49,211 - __main__ - INFO - ================================================================================
2025-12-04 10:26:49,211 - __main__ - INFO - Log file: logs\etl_pipeline_20251204_102643.log
2025-12-04 10:26:49,211 - __main__ - INFO - Duration: 5.65 seconds
2025-12-04 10:26:49,212 - __main__ - INFO - Completed at: 2025-12-04 10:26:49
2025-12-04 10:26:49,212 - __main__ - INFO - ================================================================================
